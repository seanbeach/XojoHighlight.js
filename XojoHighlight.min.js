function padWithZeros(e,n,r){return new Array(n-String(e).length+1).join(r||"0")+e}function str_repeat(e,n){for(var r=[];r.length<n;)r.push(e);return r.join("")}function IsNumerical(e){var n=e.length;if(0==n)return 0;var r,t,s;if(n>=6&&"&"==e.substr(0,5))return r=e.substr(5,1),"h"===r||"o"===r||"b"===r?1:0;for(t=1,s=0;n>s;s++){var a=e.substr(s,1);if(a>=0&&9>=a);else{if("."!==a)return 0;t=2}}if(1===t)if(10===n){if(e>2147483647)return 2}else if(n>10)return 2;return t}function FormatXojoByClass(e,n){e=e||"xojo_code";for(var r=document.getElementsByClassName(e),t=0;t<r.length;t++)r[t].innerHTML=FormatXojoCode(r[t].innerHTML,n)}function FormatXojoCode(e,n){var r,t,s,a,o,l,i,c,p,u,d,g,f,m,h,b,y,C,w,S,I,P,W,_,x,N,v={"#elseif":"#ElseIf","#bad":"#bad","#else":"#Else","#endif":"#EndIf","#if":"#If","#pragma":"#pragma","#tag":"#tag",addhandler:"AddHandler",addressof:"AddressOf",and:"And",array:"Array",as:"As",assigns:"Assigns","break":"Break",byref:"ByRef",byval:"ByVal",call:"Call","case":"Case","catch":"Catch","class":"Class","const":"Const","continue":"Continue",ctype:"CType",declare:"Declare",delegate:"Delegate",dim:"Dim","do":"Do",downto:"DownTo",each:"Each","else":"Else",elseif:"ElseIf",end:"End","enum":"Enum",event:"Event",exception:"Exception",exit:"Exit","extends":"Extends","false":"False","finally":"Finally","for":"For","function":"Function",gettypeinfo:"GetTypeInfo",global:"Global","goto":"GoTo",handles:"Handles","if":"If","implements":"Implements","in":"In",inherits:"Inherits",inline68k:"Inline68k","interface":"Interface",is:"Is",isa:"IsA",lib:"Lib",loop:"Loop",me:"Me",mod:"Mod",module:"Module",namespace:"Namespace","new":"New",next:"Next",nil:"Nil",not:"Not",object:"Object",of:"Of",optional:"Optional",or:"Or",paramarray:"ParamArray","private":"Private",property:"Property","protected":"Protected","public":"Public",raise:"Raise",raiseevent:"RaiseEvent",redim:"Redim",removehandler:"RemoveHandler","return":"Return",select:"Select",self:"Self",shared:"Shared",soft:"Soft","static":"Static",step:"Step",structure:"Structure",sub:"Sub","super":"Super",then:"Then",to:"To","true":"True","try":"Try",until:"Until",using:"Using",weakaddressof:"WeakAddressOf",wend:"Wend","while":"While","with":"With",xor:"Xor","byte":"Byte","short":"Short",integer:"Integer",int8:"Int8",int16:"Int16",int32:"Int32",int64:"Int64",uint8:"UInt8",uint16:"UInt16",uint32:"UInt32",uint64:"UInt64","boolean":"Boolean",single:"Single","double":"Double",currency:"Currency",string:"String",color:"Color",variant:"Variant",ptr:"Ptr",cstring:"CString",pstring:"pstring",wstring:"WString",cfstringref:"CFStringRef",windowptr:"WindowPtr",ostype:"OSType",controlinstance:"ControlInstance"},j={changeKeywordCase:!1,showLineNumbers:!1,padLineNumbers:"0",lineBreak:"\n",codeBlockPreWrap:'<span class="xojo_code_text">',codeBlockPostWrap:"</span>",linePreWrap:"",linePostWrap:"",lineNumberPreWrap:'<span class="xojo_code_linenumber">',lineNumberPostWrap:"  </span>",lineContentPreWrap:'<span class="xojo_code_codeline">',lineContentPostWrap:"</span>",spanClassKeyword:"xojo_code_keyword",spanClassString:"xojo_code_string",spanClassInteger:"xojo_code_integer",spanClassReal:"xojo_code_real",spanClassComment:"xojo_code_comment"};n=n||{};for(r in j)j.hasOwnProperty(r)&&!n.hasOwnProperty(r)&&(n[r]=j[r]);e=String(e).trim(),e=e.replace("&lt;","<"),e=e.replace("&gt;",">"),e=e.replace("&quot;",'"'),e=e.replace("&apos;","'"),e=e.replace("&","&"),e=e.replace("\r\n","/|**__"),e=e.replace("\r","\n"),e=e.replace("/|**__","\n"),C=new Array,C=String(e).split("\n"),S=0,I=n.codeBlockPreWrap,P=!1,W=String(C.length).length,_=!1,x=!1,N=!1,w="";for(s in C){for(I+=n.linePreWrap,w=C[s],P||(x=!1,N=!1),n.showLineNumbers&&(I+=n.lineNumberPreWrap,I+=""!==n.padLineNumbers?padWithZeros(Number(s)+1,W,n.padLineNumbers):String(Number(s)+1),I+=n.lineNumberPostWrap),I+=n.lineContentPreWrap,w=w.trim(),a=new Array,o=0,l=w.length,i="",c=!1,o=0;l>o;o++)if(p=w.substr(o,1),c&&'"'!=p)i+=p;else switch(p){case'"':c=!c;case"=":case"(":case")":case" ":case"+":case"-":case"/":case"\\":case"*":case",":case"'":case"^":""!=i&&a.push(i),a.push(p),i="";break;case".":if(!c&&("me"==i.toLowerCase()||"self"==i.toLowerCase())){a.push(i),i=".";break}default:i+=p}for(""!==i&&a.push(i),c=!1,u=!1,d=!1,g=!1,f=0,m="",a.length>0&&(m=String(a[0]).toLowerCase(),"if"==m?(f=2,x=!0):"#if"==m||"for"==m||"while"==m||"do"==m||"try"==m||"sub"==m||"function"==m||"class"==m||"module"==m||"window"==m||"controlinstance"==m||"get"==m||"set"==m||"property"==m||"structure"==m||"enum"==m||"select"==m||"event"==m?_||(f=2):"interface"==m?(_=!0,f=2):"end"==m||"#endif"==m||"next"==m||"wend"==m||"loop"==m?(S-=2,_=!1,d=!0):"else"==m||"elseif"==m||"#else"==m||"#elseif"==m||"catch"==m||"implements"==m||"inherits"==m||"case"==m?(f=2,S-=2):a.length>2&&" "==a[1]&&(h=String(a[2]).toLowerCase(),"protected"!=m&&"private"!=m&&"global"!=m&&"public"!=m||"function"!=h&&"sub"!=h||(f=2))),S>0&&(I+=str_repeat(" ",S)),P&&(I+="  "),P=!1,S+=f,t=0;t<a.length;t++)a[t]=String(a[t]).replace("&","&"),a[t]=String(a[t]).replace("<","&lt;"),a[t]=String(a[t]).replace(">","&gt;"),a[t]=String(a[t]).replace('"',"&quot;"),a[t]=String(a[t]).replace("'","&apos;"),b=!1,m=String(a[t]).toLowerCase().trim(),g||("&quot;"==m?(c?b=!0:I+='<span class="'+n.spanClassString+'">',c=!c):c||(m in v?(I+='<span class="'+n.spanClassKeyword+'">',b=!0,n.changeKeywordCase&&(a[t]=v[m])):(0!=t||"get"!=m&&"set"!=m)&&(!d||"get"!=m&&"set"!=m)?(f=IsNumerical(m))>0?(I+=1==f?'<span class="'+n.spanClassInteger+'">':'<span class="'+n.spanClassReal+'">',b=!0):"&apos;"==m.substr(0,6)||"/"==m&&t+1<a.length&&"/"==a[t+1]||"rem"==m?(g=!0,I+='<span class="'+n.spanClassComment+'">'):12==String(m).length&&"&c"==m.substr(0,6)&&(y=a[t].substr(6,6),a[t]="",I+="&c",I+='<span style="color: #FF0000;">'+y.substr(0,2)+"</span>",I+='<span style="color: #00BB00;">'+y.substr(2,2)+"</span>",I+='<span style="color: #0000FF;">'+y.substr(4,2)+"</span>"):(I+='<span class="'+n.spanClassKeyword+'">',b=!0))),g||""===m||(P="_"==m,N="then"==m),I+=a[t],b&&(I+="</span>",b=!1);!x||N||P||(S-=2),g&&(I+="</span>"),I+=n.lineContentPostWrap,I+=n.linePostWrap,s<C.length-1&&(I+=n.lineBreak)}return I+=n.codeBlockPostWrap}